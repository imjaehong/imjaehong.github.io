---
title: "2025-08-28"
tags:
    - Study
    - System Verilog
date: "2025-08-28"
thumbnail: "/assets/img/thumbnail/SystemVerilog.png"
bookmark: true
---

# APB Slave Interface RAM Design
---
Address 기준으로 broadcast 하는 구조 : BUS 구조

```verilog
/* APB_Slave 구조 참고 */
if (PWRITE) begin // 쓰기 동작
    case (PADDR[3:2]) // 주소에 따른
        2'd0: slv_reg0 <= PWDATA;
        2'd1: slv_reg1 <= PWDATA;
        2'd2: slv_reg2 <= PWDATA;
        2'd3: slv_reg3 <= PWDATA;
    endcase
end else begin // 읽기 동작
    case (PADDR[3:2]) // 주소에 따른
        2'd0: PRDATA <= slv_reg0;
        2'd1: PRDATA <= slv_reg1;
        2'd2: PRDATA <= slv_reg2;
        2'd3: PRDATA <= slv_reg3;
    endcase
end
```

기존의 RAM Code 변경, RAM 구조에서 reset 개념은 없음

### < Simulation >
![alt text](../../assets/img/final/250828/1.png)

APB는 CPU 는 ready 신호가 들어올 때까지 몇 클럭이든 대기
AHB는 파이프라인구조라서 대기하는 시간이 짧음

RAM 스택포인터 위치 0x1000_0000 ~ 0x1000_0FFF 맞춰서 

### Store, Load Test
```c
int main()
{
    int a, b, c;

    a = 1;
    b = 2;
    c = a + b;

    return 0;
}
```

```asm
		li 		sp,0x10001000
main:
        addi    sp,sp,-32
        sw      ra,28(sp)
        sw      s0,24(sp)
        addi    s0,sp,32
        li      a5,1
        sw      a5,-20(s0)
        li      a5,2
        sw      a5,-24(s0)
        lw      a4,-20(s0)
        lw      a5,-24(s0)
        add     a5,a4,a5
        sw      a5,-28(s0)
        li      a5,0
        mv      a0,a5
        lw      ra,28(sp)
        lw      s0,24(sp)
        addi    sp,sp,32
        jr      ra
```

```text
10001137
fe010113
00112e23
00812c23
02010413
00100793
fef42623
00200793
fef42423
fec42703
fe842783
00f707b3
fef42223
00000793
00078513
01c12083
01812403
02010113
00008067
```

### < Simulation >
![alt text](../../assets/img/final/250828/2.png)

# GPIO Design
---

